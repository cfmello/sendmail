<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Envio de PDF Mensal</title>
        <style>
            body { font-family: sans-serif; display: flex; justify-content: center; padding: 50px; }
            .card { border: 1px solid #ccc; padding: 20px; border-radius: 8px; }
        </style>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    </head>
    <body>
        <div class="container mt-5">
            <div class="card p-4 mx-auto" style="max-width: 500px;">
                <h2>Enviar arquivos</h2>
                
                <div id="alertContainer" class="mt-3"></div>

                <form id="uploadForm">
                    <div class="mb-3">
                        <label class="form-label">Selecione os 2 PDFs:</label>
                        <input type="file" id="pdfFiles" class="form-control" accept=".pdf" multiple required>
                    </div>
                    <button type="submit" id="btnSend" class="btn btn-primary w-100">Enviar E-mail</button>
                </form>
            </div>
        </div>
        <script>
            const form = document.getElementById('uploadForm');
            const alertContainer = document.getElementById('alertContainer');
            const btnSend = document.getElementById('btnSend');

            form.onsubmit = async (e) => {
            e.preventDefault(); // Impede o recarregamento da p√°gina

            btnSend.disabled = true;
            btnSend.innerText = 'Enviando...';

            const formData = new FormData();
            const files = document.getElementById('pdfFiles').files;

            for (let i = 0; i < files.length; i++) {
                formData.append('pdfs', files[i]);
            }

            try {
                const response = await fetch('/send-email', {
                    method: 'POST',
                    body: formData
                });

                if (response.ok) {
                    alertContainer.innerHTML = `
                        <div class="alert alert-success" role="alert">
                            E-mail enviado com sucesso!
                        </div>`;
                    form.reset(); // Limpa os campos
                } else {
                    throw new Error('Falha no envio');
                }
            } catch (error) {
                alertContainer.innerHTML = `
                    <div class="alert alert-danger" role="alert">
                        Erro ao enviar e-mail. Tente novamente.
                    </div>`;
            } finally {
                btnSend.disabled = false;
                btnSend.innerText = 'Enviar E-mail';
            }
            };
        </script>
    </body>
</html>